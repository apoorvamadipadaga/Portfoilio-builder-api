<div class="container">

  <h1>Create Portfolio</h1>

  <div *ngIf="submitted">
    <p>{{ message }}</p>
    <a href="{{uname}}" class="cta">Go to my portfolio</a>
  </div>

  <form [formGroup]="portfolioForm" (ngSubmit)="onSubmit()" *ngIf="!success">
    <label>
      Name:
      <input type="text" formControlName="name">
      <div *ngIf="submitted && portfolioForm.controls.name.errors" class="error">
        <div *ngIf="portfolioForm.controls.name.errors.required">Your name is required</div>
      </div>
    </label>

    <label>
      Username:
      <input type="text" formControlName="uname">
      <div *ngIf="submitted && portfolioForm.controls.uname.errors" class="error">
        <div *ngIf="portfolioForm.controls.uname.errors.required">Username is required</div>
      </div>
    </label>

    <label>
      User PIN:
      <input type="text" formControlName="pin">
      <div *ngIf="submitted && portfolioForm.controls.pin.errors" class="error">
        <div *ngIf="portfolioForm.controls.pin.errors.required">User PIN is required</div>
        <div *ngIf="portfolioForm.controls.pin.errors.pattern">User PIN should consist of only 4 numbers</div>
      </div>
    </label>

    <label>
      Summary:
      <textarea formControlName="description" rows="7"></textarea>
      <div *ngIf="submitted && portfolioForm.controls.description.errors" class="error">
        <div *ngIf="portfolioForm.controls.description.errors.required">Summary is required</div>
      </div>
    </label>

    <div formArrayName="skills">
      <h3>Skills</h3>
      <button type="button" (click)="addSkill()" class="cta">Add Skill</button><br><br>

      <div *ngFor="let s of skills.controls; let i=index">
        <label>
          <div [formGroupName]="i">
            <input type="text" formControlName="skillname">
          </div>
        </label>
      </div>
    </div>
    <div formArrayName="achievements">
      <h3>Achievements</h3>
      <button type="button" (click)="addAchievement()" class="cta">Add Achievement</button><br><br>

      <div *ngFor="let a of achievements.controls; let i=index">
        <label>
          <div [formGroupName]="i">
            <input type="text" formControlName="achievement">
          </div>
        </label>
      </div>
    </div>

    <div formArrayName="projects">
      <h3>Projects</h3>
      <button type="button" (click)="addProject()" class="cta">Add Project</button><br><br>

      <div *ngFor="let p of projects.controls; let i=index">
        <label>
          <h4>Project {{ (i + 1) }}</h4>
          <div [formGroupName]="i">
            Title:
            <input type="text" formControlName="title">
            Description:
            <textarea formControlName="description" rows="7"></textarea>
            Start Date:
            <input type="date" formControlName="startDate">
            End Date:
            <input type="date" formControlName="endDate">
          </div>
          <hr>
        </label>
      </div>
    </div>
    <br>
    <input type="submit" value="Create" class="cta">
  </form>
</div>